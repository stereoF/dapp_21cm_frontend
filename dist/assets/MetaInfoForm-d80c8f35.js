import{d as F,s as w,g as b,h as V,u as U,_ as I,o as c,c as d,b as t,i as u,v as m,F as h,j as y,k as g,l as A,p as P,m as $}from"./index-6aaf6acf.js";import{P as M}from"./PrePrintTrack-81cb0c9d.js";import{u as E}from"./upload-ad8f6267.js";import{C as N}from"./index-24014245.js";const T=F({name:"MetaInfo",props:{address:String},setup(e){const n=E(),{cid:_}=w(n),f=b(""),v=b(""),l=V({authors:[{name:"",email:"",workplace:""}],fields:[{field:""}]});let o=b(!1),a=b(!1);return{cid:_,title:f,abstract:v,...l,addAuthor:i=>{l.authors.splice(i+1,0,{name:"",email:"",workplace:""})},removeAuthor:i=>{l.authors.length>1&&l.authors.splice(i,1)},addField:i=>{l.fields.splice(i+1,0,{field:""})},removeField:i=>{l.fields.length>1&&l.fields.splice(i,1)},contractCall:async()=>{const{provider:i}=await U(),k=i.getSigner(),C=new N(e.address||"",M.abi,i).connect(k),S={...l,title:f.value,abstract:v.value};try{await C.submit(_.value,f.value,JSON.stringify(S)),a.value=!0,o.value=!1}catch(r){console.error(r),o.value=!0,a.value=!1}finally{l.authors.forEach(r=>{r.name="",r.email="",r.workplace=""}),l.fields.forEach(r=>{r.field=""}),f.value="",v.value="",_.value=""}},submitFailed:o,submitSucceed:a}}});const p=e=>(P("data-v-57fda970"),e=e(),$(),e),B={class:"container mt-4"},D=p(()=>t("h2",null,"Meta Information need submitting to Preprint Repository",-1)),R={class:"form-group"},W=p(()=>t("label",{for:"cid"},"CID:",-1)),j={class:"form-group"},J=p(()=>t("label",{for:"title"},"Title:",-1)),L={class:"form-group"},O=p(()=>t("label",{for:"authors"},"Authors:",-1)),q={class:"col-3 pr-1"},z=["onUpdate:modelValue"],G={class:"col-4 px-1"},H=["onUpdate:modelValue"],K={class:"col-4 pl-1"},Q=["onUpdate:modelValue"],X={class:"col-1 author-buttons"},Y=["onClick"],Z=["onClick"],x={class:"form-group"},tt=p(()=>t("label",{for:"fields"},"Fields:",-1)),et={class:"col-10 pr-1"},ot=["onUpdate:modelValue"],st={class:"col-1 author-buttons"},lt=["onClick"],at=["onClick"],nt={class:"form-group"},it=p(()=>t("label",{for:"abstract"},"Abstract:",-1)),rt={class:"row mt-2"},ct=p(()=>t("div",{class:"col-12 col-sm-8"},[t("button",{id:"contractCall",type:"submit",class:"btn btn-primary"},"Submit")],-1)),dt={class:"col-12 col-sm-4 mt-2 mt-sm-0"},ut={key:0,class:"text-danger"},mt={key:1,class:"text-success"};function pt(e,n,_,f,v,l){return c(),d("div",B,[D,t("form",{onSubmit:n[3]||(n[3]=A((...o)=>e.contractCall&&e.contractCall(...o),["prevent"]))},[t("div",R,[W,u(t("input",{type:"text",id:"cid",class:"form-control","onUpdate:modelValue":n[0]||(n[0]=o=>e.cid=o),placeholder:"Select directory to get CID"},null,512),[[m,e.cid]])]),t("div",j,[J,u(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":n[1]||(n[1]=o=>e.title=o)},null,512),[[m,e.title]])]),t("div",L,[O,(c(!0),d(h,null,y(e.authors,(o,a)=>(c(),d("div",{key:a,class:"row align-items-center"},[t("div",q,[u(t("input",{type:"text","onUpdate:modelValue":s=>o.name=s,placeholder:"Name",class:"form-control"},null,8,z),[[m,o.name]])]),t("div",G,[u(t("input",{type:"email","onUpdate:modelValue":s=>o.email=s,placeholder:"Email",class:"form-control"},null,8,H),[[m,o.email]])]),t("div",K,[u(t("input",{type:"text","onUpdate:modelValue":s=>o.workplace=s,placeholder:"Workplace",class:"form-control"},null,8,Q),[[m,o.workplace]])]),t("div",X,[t("div",null,[t("button",{type:"button",onClick:s=>e.addAuthor(a),class:"btn btn-success btn-sm"},"+",8,Y)]),t("div",null,[t("button",{type:"button",onClick:s=>e.removeAuthor(a),class:"btn btn-danger btn-sm"},"-",8,Z)])])]))),128))]),t("div",x,[tt,(c(!0),d(h,null,y(e.fields,(o,a)=>(c(),d("div",{key:a,class:"row align-items-center"},[t("div",et,[u(t("input",{type:"text","onUpdate:modelValue":s=>o.field=s,placeholder:"Field",class:"form-control"},null,8,ot),[[m,o.field]])]),t("div",st,[t("div",null,[t("button",{type:"button",onClick:s=>e.addField(a),class:"btn btn-success btn-sm"},"+",8,lt)]),t("div",null,[t("button",{type:"button",onClick:s=>e.removeField(a),class:"btn btn-danger btn-sm"},"-",8,at)])])]))),128))]),t("div",nt,[it,u(t("textarea",{id:"abstract","onUpdate:modelValue":n[2]||(n[2]=o=>e.abstract=o),class:"form-control"},null,512),[[m,e.abstract]])]),t("div",rt,[ct,t("div",dt,[e.submitFailed?(c(),d("div",ut,"Submit Failed")):g("",!0),e.submitSucceed?(c(),d("div",mt,"Submit Succeed")):g("",!0)])])],32)])}const St=I(T,[["render",pt],["__scopeId","data-v-57fda970"]]);export{St as default};
