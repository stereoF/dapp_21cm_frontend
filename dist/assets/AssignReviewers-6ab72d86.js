import{D as P}from"./DeSciPrint-fa65339c.js";import{M as A}from"./ManagerFields-c19fd72a.js";import{P as N}from"./PaperInfo-b25b6f5f.js";import{d as R,g as a,u as $,h as S,_ as M,r as b,o as i,c,b as t,t as B,e as V,w as y,S as j,a as C,k as I,l as D,f as E,p as L,m as q}from"./index-6aaf6acf.js";import{C as J}from"./index-24014245.js";const T=R({name:"AssignReviewers",props:{address:{type:String,required:!0},paperId:{type:String,required:!0}},async setup(e){const o=a(),{provider:n}=await $(),r=new J(e.address,P.abi,n),u=a(e.paperId),f=S(await r.editors()),p=a(await r.name()),d=S(await r.getReviewers(u.value)),l=a(await n.getSigner().getAddress()),F=a(f.includes(l.value));let m=a(!1),v=a(!1);return{journalName:p,contractCall:async()=>{let _=o.value.fields.map(s=>s.field),g=d.filter(s=>_.includes(s)),w=_.filter(s=>!g.includes(s)),h=d.filter(s=>!g.includes(s));try{w.length>0&&await r.connect(n.getSigner()).reviewerAssign(u.value,w),h.length>0&&await r.connect(n.getSigner()).removeReviewer(u.value,h),v.value=!0,m.value=!1}catch(s){console.error(s),m.value=!0,v.value=!1}},submitFailed:m,submitSucceed:v,reviewers:d,reviewerFields:o,isEditor:F}},components:{ManagerFields:A,PaperInfo:N}});const k=e=>(L("data-v-ce44e2f4"),e=e(),q(),e),Y={class:"container"},x=k(()=>t("div",{class:"divider"},null,-1)),z={key:0,class:"text-danger"},G={key:1},H={class:"row mt-2"},K=k(()=>t("div",{class:"col-12 col-sm-8"},[t("button",{id:"contractCall",type:"submit",class:"btn btn-primary"},"Submit")],-1)),O={class:"col-12 col-sm-4 mt-2 mt-sm-0"},Q={key:0,class:"text-danger"},U={key:1,class:"text-success"};function W(e,o,n,r,u,f){const p=b("PaperInfo"),d=b("ManagerFields");return i(),c("div",Y,[t("h2",null,"Journal name: "+B(e.journalName),1),t("div",null,[(i(),V(j,null,{fallback:y(()=>[E(" Loading... ")]),default:y(()=>[C(p,{address:e.$props.address,cid:e.$props.paperId},null,8,["address","cid"])]),_:1}))]),x,e.isEditor?(i(),c("div",G,[t("form",{onSubmit:o[0]||(o[0]=D((...l)=>e.contractCall&&e.contractCall(...l),["prevent"]))},[C(d,{"field-name":"Reviewer",fields:e.reviewers.map(l=>({field:l})),ref:"reviewerFields"},null,8,["fields"]),t("div",H,[K,t("div",O,[e.submitFailed?(i(),c("div",Q,"Submit failed")):I("",!0),e.submitSucceed?(i(),c("div",U,"Submit succeed")):I("",!0)])])],32)])):(i(),c("div",z,"You are not the editor of this journal"))])}const re=M(T,[["render",W],["__scopeId","data-v-ce44e2f4"]]);export{re as default};
