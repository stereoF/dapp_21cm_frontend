import{d as N,g as r,n as y,r as w,o as c,c as p,a as l,w as d,b as t,t as I,q as f,l as B,e as M,f as V,S as D,k as x,u as q,x as k,p as J,m as j,_ as A}from"./index-6aaf6acf.js";import{F as L}from"./FileUpload-4c08f7c5.js";import{M as O}from"./MetaForm-197e38e5.js";import{D as R}from"./DeSciPrint-fa65339c.js";import{C as T}from"./index-24014245.js";import"./upload-ad8f6267.js";const U=o=>(J("data-v-f740ded5"),o=o(),j(),o),W={class:"common-layout"},z={class:"container"},G={class:"file-upload-container"},H={class:"container mt-4"},K=["onSubmit"],Q={class:"row mt-2"},X=U(()=>t("div",{class:"col-12 col-sm-8"},[t("button",{id:"contractCall",type:"submit",class:"btn btn-primary"},"Submit")],-1)),Y={class:"col-12 col-sm-4 mt-2 mt-sm-0"},Z={key:0,class:"text-danger"},$={key:1,class:"text-success"},ee=N({__name:"SubmitPage",props:{address:{type:String,required:!0}},async setup(o){let a,n;const v=o,e=r(),{provider:h}=([a,n]=y(()=>q()),a=await a,n(),a),b=new T(v.address,R.abi,h);let C=r(([a,n]=y(()=>b.name()),a=await a,n(),a)),u=r(!1),m=r(!1);const F=async()=>{const S={authors:e.value.authors,fields:e.value.fields,title:e.value.title,abstract:e.value.abstract},g=h.getSigner(),_=b.connect(g);let i=k(e.value.donate),P=k(e.value.gas),E=i.add(P);try{await _.submitForReview(e.value.cid,e.value.title,JSON.stringify(S),i,{value:E}),m.value=!0,u.value=!1}catch(s){console.error(s),u.value=!0,m.value=!1}finally{e.value.authors.forEach(s=>{s.name="",s.email="",s.workplace=""}),e.value.fields.forEach(s=>{s.field=""}),e.value.title="",e.value.abstract="",e.value.cid=""}};return(S,g)=>{const _=w("el-main"),i=w("el-container");return c(),p("div",W,[l(i,null,{default:d(()=>[l(_,null,{default:d(()=>[t("div",z,[t("div",G,[l(L)]),t("div",H,[t("h2",null,"Meta Information need submitting to Journal: "+I(f(C)),1),t("form",{onSubmit:B(F,["prevent"])},[(c(),M(D,null,{fallback:d(()=>[V(" Loading... ")]),default:d(()=>[l(O,{address:v.address,ref_key:"metaForm",ref:e},null,8,["address"])]),_:1})),t("div",Q,[X,t("div",Y,[f(u)?(c(),p("div",Z,"Submit failed")):x("",!0),f(m)?(c(),p("div",$,"Submit succeed")):x("",!0)])])],40,K)])])]),_:1})]),_:1})])}}});const re=A(ee,[["__scopeId","data-v-f740ded5"]]);export{re as default};
